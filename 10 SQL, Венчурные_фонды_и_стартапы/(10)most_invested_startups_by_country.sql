/* Проанализируйте, в каких странах находятся фонды, которые чаще всего инвестируют в стартапы. */
SELECT country_code,
       MIN(invested_companies),     -- Минимальное количество компаний, в которые фонд инвестировал
       MAX(invested_companies),     -- Максимальное количество компаний, в которые фонд инвестировал
       AVG(invested_companies)      -- Среднее количество компаний, в которые фонд инвестировал
FROM fund
-- Отбираем только фонды, которые были основаны в 2010, 2011 или 2012 году
WHERE EXTRACT(YEAR FROM CAST(founded_at AS date)) IN (2010, 2011, 2012)
-- Группируем данные по коду страны
GROUP BY country_code
-- Исключаем фонды, которые не инвестировали ни в одну компанию
HAVING MIN(invested_companies) != 0
-- Сортируем по убыванию среднего количества инвестированных компаний, затем по возрастанию кода страны
ORDER BY AVG(invested_companies) DESC,
         country_code ASC
-- Ограничиваем результат первыми 10 странами
LIMIT 10;
