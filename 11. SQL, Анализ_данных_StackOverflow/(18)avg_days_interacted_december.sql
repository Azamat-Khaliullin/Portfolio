-- Задание: Сколько в среднем дней в период с 1 по 7 декабря 2008 года включительно пользователи взаимодействовали с платформой?
-- Для каждого пользователя отберите дни, в которые он или она опубликовали хотя бы один пост.
-- Нужно получить одно целое число — не забудьте округлить результат.

SELECT ROUND(AVG(ttr)) AS avg_days_interacted
FROM (
    -- Подзапрос для подсчета количества уникальных дней взаимодействия для каждого пользователя
    SELECT
        user_id,                                        -- Идентификатор пользователя
        COUNT(DISTINCT creation_date::date) AS ttr     -- Количество уникальных дней взаимодействия
    FROM stackoverflow.posts
    WHERE creation_date BETWEEN '2008-12-01' AND '2008-12-07'  -- Период с 1 по 7 декабря 2008 года
    GROUP BY user_id                                -- Группировка по пользователю
) AS act;
